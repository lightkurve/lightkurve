

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lightkurve.search &mdash; lightkurve 1.0b26.dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> lightkurve
          

          
            
            <img src="../../_static/lightkurve.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0b26.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section1.html">Introduction to lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section2.html">Science with lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section3.html">Extracting lightcurves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section4.html">Systematics correction</a></li>
</ul>
<p class="caption"><span class="caption-text">About lightkurve</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing and reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing and acknowledging lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other_software.html">Other software</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">lightkurve</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>lightkurve.search</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for lightkurve.search</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Defines tools to retrieve Kepler data from the archive at MAST.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="k">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Row</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="k">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">ascii</span><span class="p">,</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.utils.exceptions</span> <span class="k">import</span> <span class="n">AstropyWarning</span>

<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="k">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">astroquery.exceptions</span> <span class="k">import</span> <span class="n">ResolverError</span>

<span class="kn">from</span> <span class="nn">.collections</span> <span class="k">import</span> <span class="n">TargetPixelFileCollection</span><span class="p">,</span> <span class="n">LightCurveFileCollection</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">suppress_stdout</span><span class="p">,</span> <span class="n">LightkurveWarning</span><span class="p">,</span> <span class="n">detect_filetype</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">PACKAGEDIR</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;search_targetpixelfile&#39;</span><span class="p">,</span> <span class="s1">&#39;search_lightcurvefile&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">SearchError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">SearchResult</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Container for the results returned by `search_targetpixelfile` or</span>
<span class="sd">    `search_lightcurvefile`.</span>

<span class="sd">    The purpose of this class is to provide a convenient way to inspect and</span>
<span class="sd">    download products that have been identified using one of the data search</span>
<span class="sd">    functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table : `astropy.table.Table` object</span>
<span class="sd">        Astropy table returned by a join of the astroquery `Observations.query_criteria()`</span>
<span class="sd">        and `Observations.get_product_list()` methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;SearchResult containing </span><span class="si">{}</span><span class="s1"> data products.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;obsID&#39;</span><span class="p">,</span> <span class="s1">&#39;target_name&#39;</span><span class="p">,</span> <span class="s1">&#39;productFilename&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">out</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">max_width</span><span class="o">=</span><span class="mi">300</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Implements indexing and slicing, e.g. SearchResult[2:5].&quot;&quot;&quot;</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="c1"># Indexing a Table with an integer will return a Row</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SearchResult</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">selection</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of products in the SearchResult table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a table of targets and their RA &amp; dec values produced by search&quot;&quot;&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;target_name&#39;</span><span class="p">,</span> <span class="s1">&#39;s_ra&#39;</span><span class="p">,</span> <span class="s1">&#39;s_dec&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;target_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">obsid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an array of MAST observation IDs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;obsid&#39;</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an array of target names&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;target_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an array of RA values for targets in search&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;s_ra&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an array of dec values for targets in search&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;s_dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span>

    <span class="nd">@suppress_stdout</span>
    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quality_bitmask</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a single `KeplerTargetPixelFile` or `KeplerLightCurveFile` object.</span>

<span class="sd">        If multiple files are present in `SearchResult.table`, only the first</span>
<span class="sd">        will be downloaded.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        quality_bitmask : str or int</span>
<span class="sd">            Bitmask (integer) which identifies the quality flag bitmask that should</span>
<span class="sd">            be used to mask out bad cadences. If a string is passed, it has the</span>
<span class="sd">            following meaning:</span>

<span class="sd">                * &quot;none&quot;: no cadences will be ignored (`quality_bitmask=0`).</span>
<span class="sd">                * &quot;default&quot;: cadences with severe quality issues will be ignored</span>
<span class="sd">                  (`quality_bitmask=1130799`).</span>
<span class="sd">                * &quot;hard&quot;: more conservative choice of flags to ignore</span>
<span class="sd">                  (`quality_bitmask=1664431`). This is known to remove good data.</span>
<span class="sd">                * &quot;hardest&quot;: removes all data that has been flagged</span>
<span class="sd">                  (`quality_bitmask=2096639`). This mask is not recommended.</span>

<span class="sd">            See the :class:`KeplerQualityFlags` class for details on the bitmasks.</span>
<span class="sd">        download_dir : str</span>
<span class="sd">            Location where the data files will be stored.</span>
<span class="sd">            Defaults to &quot;~/.lightkurve-cache&quot; if `None` is passed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        data : `TargetPixelFile` or `LightCurveFile` object</span>
<span class="sd">            The first entry in the products table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Cannot download from an empty search result.&quot;</span><span class="p">,</span>
                          <span class="n">LightkurveWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Warning: </span><span class="si">{}</span><span class="s1"> files available to download. &#39;</span>
                          <span class="s1">&#39;Only the first file has been downloaded. &#39;</span>
                          <span class="s1">&#39;Please use `download_all()` or specify additional &#39;</span>
                          <span class="s1">&#39;criteria (e.g. quarter, campaign, or sector) &#39;</span>
                          <span class="s1">&#39;to limit your search.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)),</span>
                          <span class="n">LightkurveWarning</span><span class="p">)</span>

        <span class="c1"># Make sure astroquery uses the same level of verbosity</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;astropy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">())</span>

        <span class="c1"># download first product in table</span>
        <span class="k">if</span> <span class="n">download_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">download_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_download_dir</span><span class="p">()</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                              <span class="n">download_dir</span><span class="o">=</span><span class="n">download_dir</span><span class="p">)[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]</span>

        <span class="c1"># open() will determine filetype and return</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">quality_bitmask</span><span class="o">=</span><span class="n">quality_bitmask</span><span class="p">)</span>

    <span class="nd">@suppress_stdout</span>
    <span class="k">def</span> <span class="nf">download_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quality_bitmask</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a `TargetPixelFileCollection or `LightCurveFileCollection`.</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>
<span class="sd">         quality_bitmask : str or int</span>
<span class="sd">             Bitmask (integer) which identifies the quality flag bitmask that should</span>
<span class="sd">             be used to mask out bad cadences. If a string is passed, it has the</span>
<span class="sd">             following meaning:</span>

<span class="sd">                 * &quot;none&quot;: no cadences will be ignored (`quality_bitmask=0`).</span>
<span class="sd">                 * &quot;default&quot;: cadences with severe quality issues will be ignored</span>
<span class="sd">                   (`quality_bitmask=1130799`).</span>
<span class="sd">                 * &quot;hard&quot;: more conservative choice of flags to ignore</span>
<span class="sd">                   (`quality_bitmask=1664431`). This is known to remove good data.</span>
<span class="sd">                 * &quot;hardest&quot;: removes all data that has been flagged</span>
<span class="sd">                   (`quality_bitmask=2096639`). This mask is not recommended.</span>

<span class="sd">             See the :class:`KeplerQualityFlags` class for details on the bitmasks.</span>
<span class="sd">        download_dir : str</span>
<span class="sd">            Location where the data files will be stored.</span>
<span class="sd">            Defaults to &quot;~/.lightkurve-cache&quot; if `None` is passed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collection : `lightkurve.Collection` object</span>
<span class="sd">            Returns a `LightCurveFileCollection`  or `TargetPixelFileCollection`,</span>
<span class="sd">            containing all entries in the products table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Cannot download from an empty search result.&quot;</span><span class="p">,</span>
                          <span class="n">LightkurveWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Make sure astroquery uses the same level of verbosity</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;astropy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">())</span>

        <span class="c1"># download all products listed in self.products</span>
        <span class="k">if</span> <span class="n">download_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">download_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_download_dir</span><span class="p">()</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                              <span class="n">download_dir</span><span class="o">=</span><span class="n">download_dir</span><span class="p">)[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]</span>

        <span class="c1"># open() will determine filetype and return</span>
        <span class="c1"># return a collection containing opened files</span>
        <span class="n">tpf_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lpd-targ.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;spd-targ.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;_tp.fits&#39;</span><span class="p">]</span>
        <span class="n">lcf_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;llc.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;slc.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;_lc.fits&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tpf_extensions</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TargetPixelFileCollection</span><span class="p">([</span><span class="nb">open</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">lcf_extensions</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LightCurveFileCollection</span><span class="p">([</span><span class="nb">open</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_default_download_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the default path to the directory where files will be downloaded.</span>

<span class="sd">        By default, this method will return &quot;~/.lightkurve-cache&quot; and create</span>
<span class="sd">        this directory if it does not exist.  If the directory cannot be</span>
<span class="sd">        access or created, then it returns the local directory (&quot;.&quot;).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        download_dir : str</span>
<span class="sd">            Path to location of `mastDownload` folder where data downloaded from MAST are stored</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">download_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;.lightkurve-cache&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">download_dir</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">download_dir</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if it doesn&#39;t exist, make a new cache directory</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">download_dir</span><span class="p">)</span>
            <span class="c1"># downloads locally if OS error occurs</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Warning: unable to create </span><span class="si">{}</span><span class="s1">. &#39;</span>
                            <span class="s1">&#39;Downloading MAST files to the current &#39;</span>
                            <span class="s1">&#39;working directory instead.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">download_dir</span><span class="p">))</span>
                <span class="n">download_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>

        <span class="k">return</span> <span class="n">download_dir</span>


<div class="viewcode-block" id="search_targetpixelfile"><a class="viewcode-back" href="../../api/lightkurve.search.search_targetpixelfile.html#lightkurve.search.search_targetpixelfile">[docs]</a><span class="k">def</span> <span class="nf">search_targetpixelfile</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span>
                           <span class="n">mission</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Kepler&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;TESS&#39;</span><span class="p">],</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Searches MAST for Target Pixel Files.</span>

<span class="sd">    This function fetches a data table that lists the Target Pixel Files (TPFs)</span>
<span class="sd">    that fall within a region of sky centered around the position of `target`</span>
<span class="sd">    and within a cone of a given `radius`. If no value is provided for `radius`,</span>
<span class="sd">    only a single target will be returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : str, int, or `astropy.coordinates.SkyCoord` object</span>
<span class="sd">        Target around which to search. Valid inputs include:</span>

<span class="sd">            * The name of the object as a string, e.g. &quot;Kepler-10&quot;.</span>
<span class="sd">            * The KIC or EPIC identifier as an integer, e.g. 11904151.</span>
<span class="sd">            * A coordinate string in decimal format, e.g. &quot;285.67942179 +50.24130576&quot;.</span>
<span class="sd">            * A coordinate string in sexagesimal format, e.g. &quot;19:02:43.1 +50:14:28.7&quot;.</span>
<span class="sd">            * An `astropy.coordinates.SkyCoord` object.</span>
<span class="sd">    radius : float or `astropy.units.Quantity` object</span>
<span class="sd">        Conesearch radius.  If a float is given it will be assumed to be in</span>
<span class="sd">        units of arcseconds.  If `None` then we default to 0.0001 arcsec.</span>
<span class="sd">    cadence : str</span>
<span class="sd">        &#39;long&#39; or &#39;short&#39;.</span>
<span class="sd">    mission : str, list of str</span>
<span class="sd">        &#39;Kepler&#39;, &#39;K2&#39;, or &#39;TESS&#39;. By default, all will be returned.</span>
<span class="sd">    quarter, campaign, sector : int, list of ints</span>
<span class="sd">        Kepler Quarter, K2 Campaign, or TESS Sector number.</span>
<span class="sd">        By default all quarters/campaigns/sectors will be returned.</span>
<span class="sd">    month : 1, 2, 3, 4 or list of int</span>
<span class="sd">        For Kepler&#39;s prime mission, there are three short-cadence</span>
<span class="sd">        TargetPixelFiles for each quarter, each covering one month.</span>
<span class="sd">        Hence, if cadence=&#39;short&#39; you can specify month=1, 2, 3, or 4.</span>
<span class="sd">        By default all months will be returned.</span>
<span class="sd">    limit : int</span>
<span class="sd">        Maximum number of products to return.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : :class:`SearchResult` object</span>
<span class="sd">        Object detailing the data products found.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    This example demonstrates how to use the `search_targetpixelfile()` function to</span>
<span class="sd">    query and download data. Before instantiating a `KeplerTargetPixelFile` object or</span>
<span class="sd">    downloading any science products, we can identify potential desired targets with</span>
<span class="sd">    `search_targetpixelfile()`::</span>

<span class="sd">        &gt;&gt;&gt; search_result = search_targetpixelfile(&#39;Kepler-10&#39;)  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; print(search_result)  # doctest: +SKIP</span>

<span class="sd">    The above code will query mast for Target Pixel Files (TPFs) available for</span>
<span class="sd">    the known planet system Kepler-10, and display a table containing the</span>
<span class="sd">    available science products. Because Kepler-10 was observed during 15 Quarters,</span>
<span class="sd">    the table will have 15 entries. If we want to download a</span>
<span class="sd">    `TargetPixelFileCollection` object containing all 15 observations, use::</span>

<span class="sd">        &gt;&gt;&gt; search_result.download_all()  # doctest: +SKIP</span>

<span class="sd">    or we can download a single product by limiting our search::</span>

<span class="sd">        &gt;&gt;&gt; lcf = search_targetpixelfile(&#39;Kepler-10&#39;, quarter=2).download()  # doctest: +SKIP</span>

<span class="sd">    The above line of code will only download Quarter 2 and create a single</span>
<span class="sd">    `KeplerTargetPixelFile` object called lcf.</span>

<span class="sd">    We can also pass a radius into `search_targetpixelfile` to perform a cone search::</span>

<span class="sd">        &gt;&gt;&gt; search_targetpixelfile(&#39;Kepler-10&#39;, radius=100).targets  # doctest: +SKIP</span>

<span class="sd">    This will display a table containing all targets within 100 arcseconds of Kepler-10.</span>
<span class="sd">    We can download a `TargetPixelFileCollection` object containing all available products</span>
<span class="sd">    for these targets in Quarter 4 with::</span>

<span class="sd">        &gt;&gt;&gt; search_targetpixelfile(&#39;Kepler-10&#39;, radius=100, quarter=4).download_all()  # doctest: +SKIP</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_search_products</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;Target Pixel&quot;</span><span class="p">,</span>
                                <span class="n">cadence</span><span class="o">=</span><span class="n">cadence</span><span class="p">,</span> <span class="n">mission</span><span class="o">=</span><span class="n">mission</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="n">quarter</span><span class="p">,</span>
                                <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="n">campaign</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="n">sector</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">SearchError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SearchResult</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="search_lightcurvefile"><a class="viewcode-back" href="../../api/lightkurve.search.search_lightcurvefile.html#lightkurve.search.search_lightcurvefile">[docs]</a><span class="k">def</span> <span class="nf">search_lightcurvefile</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span>
                          <span class="n">mission</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Kepler&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;TESS&#39;</span><span class="p">],</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a SearchResult with MAST LightCurveFiles which match the criteria.</span>

<span class="sd">    This function fetches a data table that lists the Light Curve Files</span>
<span class="sd">    that fall within a region of sky centered around the position of `target`</span>
<span class="sd">    and within a cone of a given `radius`. If no value is provided for `radius`,</span>
<span class="sd">    only a single target will be returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : str, int, or `astropy.coordinates.SkyCoord` object</span>
<span class="sd">        Target around which to search. Valid inputs include:</span>

<span class="sd">            * The name of the object as a string, e.g. &quot;Kepler-10&quot;.</span>
<span class="sd">            * The KIC or EPIC identifier as an integer, e.g. 11904151.</span>
<span class="sd">            * A coordinate string in decimal format, e.g. &quot;285.67942179 +50.24130576&quot;.</span>
<span class="sd">            * A coordinate string in sexagesimal format, e.g. &quot;19:02:43.1 +50:14:28.7&quot;.</span>
<span class="sd">            * An `astropy.coordinates.SkyCoord` object.</span>
<span class="sd">    radius : float or `astropy.units.Quantity` object</span>
<span class="sd">        Conesearch radius.  If a float is given it will be assumed to be in</span>
<span class="sd">        units of arcseconds.  If `None` then we default to 0.0001 arcsec.</span>
<span class="sd">    cadence : str</span>
<span class="sd">        &#39;long&#39; or &#39;short&#39;.</span>
<span class="sd">    mission : str, list of str</span>
<span class="sd">        &#39;Kepler&#39;, &#39;K2&#39;, or &#39;TESS&#39;. By default, all will be returned.</span>
<span class="sd">    quarter, campaign, sector : int, list of ints</span>
<span class="sd">        Kepler Quarter, K2 Campaign, or TESS Sector number.</span>
<span class="sd">        By default all quarters/campaigns/sectors will be returned.</span>
<span class="sd">    month : 1, 2, 3, 4 or list of int</span>
<span class="sd">        For Kepler&#39;s prime mission, there are three short-cadence</span>
<span class="sd">        TargetPixelFiles for each quarter, each covering one month.</span>
<span class="sd">        Hence, if cadence=&#39;short&#39; you can specify month=1, 2, 3, or 4.</span>
<span class="sd">        By default all months will be returned.</span>
<span class="sd">    limit : int</span>
<span class="sd">        Maximum number of products to return.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : :class:`SearchResult` object</span>
<span class="sd">        Object detailing the data products found.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    This example demonstrates how to use the `search_lightcurvefile()` function to</span>
<span class="sd">    query and download data. Before instantiating a `KeplerLightCurveFile` object or</span>
<span class="sd">    downloading any science products, we can identify potential desired targets with</span>
<span class="sd">    `search_lightcurvefile`::</span>

<span class="sd">        &gt;&gt;&gt; from lightkurve import search_lightcurvefile  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; search_result = search_lightcurvefile(&quot;Kepler-10&quot;)  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; print(search_result)  # doctest: +SKIP</span>

<span class="sd">    The above code will query mast for lightcurve files available for the known</span>
<span class="sd">    planet system Kepler-10, and display a table containing the available</span>
<span class="sd">    data products. Because Kepler-10 was observed in 15 quarters, the search</span>
<span class="sd">    result will list 15 different files. If we want to download a</span>
<span class="sd">    `LightCurveFileCollection` object containing all 15 observations, use::</span>

<span class="sd">        &gt;&gt;&gt; search_result.download_all()  # doctest: +SKIP</span>

<span class="sd">    or we can specify the downloaded products by limiting our search::</span>

<span class="sd">        &gt;&gt;&gt; lcf = search_lightcurvefile(&#39;Kepler-10&#39;, quarter=2).download()  # doctest: +SKIP</span>

<span class="sd">    The above line of code will only search and download Quarter 2 data and</span>
<span class="sd">    create a `LightCurveFile` object called lcf.</span>

<span class="sd">    We can also pass a radius into `search_lightcurvefile` to perform a cone search::</span>

<span class="sd">        &gt;&gt;&gt; search_lightcurvefile(&#39;Kepler-10&#39;, radius=100, quarter=4)  # doctest: +SKIP</span>

<span class="sd">    This will display a table containing all targets within 100 arcseconds of</span>
<span class="sd">    Kepler-10 and in Quarter 4.  We can then download a `LightCurveFileCollection`</span>
<span class="sd">    containing all these products using::</span>

<span class="sd">        &gt;&gt;&gt; search_lightcurvefile(&#39;kepler-10&#39;, radius=100, quarter=4).download_all()  # doctest: +SKIP</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_search_products</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;Lightcurve&quot;</span><span class="p">,</span>
                                <span class="n">cadence</span><span class="o">=</span><span class="n">cadence</span><span class="p">,</span> <span class="n">mission</span><span class="o">=</span><span class="n">mission</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="n">quarter</span><span class="p">,</span>
                                <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="n">campaign</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="n">sector</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">SearchError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SearchResult</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_search_products</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;Lightcurve&quot;</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span>
                     <span class="n">mission</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Kepler&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;TESS&#39;</span><span class="p">],</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">campaign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function which returns a SearchResult object containing MAST</span>
<span class="sd">    products that match several criteria.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : str, int, or `astropy.coordinates.SkyCoord` object</span>
<span class="sd">        See docstrings above.</span>
<span class="sd">    radius : float or `astropy.units.Quantity` object</span>
<span class="sd">        Conesearch radius.  If a float is given it will be assumed to be in</span>
<span class="sd">        units of arcseconds.  If `None` then we default to 0.0001 arcsec.</span>
<span class="sd">    filetype : str</span>
<span class="sd">        Type of files queried at MAST (`Target Pixel` or `Lightcurve`)</span>
<span class="sd">    cadence : str</span>
<span class="sd">        Desired cadence (`long`, `short`, `any`)</span>
<span class="sd">    mission : str, list of str</span>
<span class="sd">        &#39;Kepler&#39;, &#39;K2&#39;, or &#39;TESS&#39;. By default, all will be returned.</span>
<span class="sd">    quarter, campaign, sector : int, list of ints</span>
<span class="sd">        Kepler Quarter, K2 Campaign, or TESS Sector number.</span>
<span class="sd">        By default all quarters/campaigns/sectors will be returned.</span>
<span class="sd">    month : 1, 2, 3, 4 or list of int</span>
<span class="sd">        For Kepler&#39;s prime mission, there are three short-cadence</span>
<span class="sd">        TargetPixelFiles for each quarter, each covering one month.</span>
<span class="sd">        Hence, if cadence=&#39;short&#39; you can specify month=1, 2, 3, or 4.</span>
<span class="sd">        By default all months will be returned.</span>
<span class="sd">    limit : int</span>
<span class="sd">        Maximum number of products to return</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SearchResult : :class:`SearchResult` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="n">_query_mast</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">mission</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>

    <span class="c1"># mask out FFIs from observations</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;FFI&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;target_name&#39;</span><span class="p">]</span> <span class="ow">and</span>
                     <span class="s1">&#39;FFI&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;obs_collection&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">observations</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SearchError</span><span class="p">(</span><span class="s1">&#39;No data found for target &quot;</span><span class="si">{}</span><span class="s1">&quot;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

    <span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">observations</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">observations</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">,</span> <span class="n">join_type</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                  <span class="n">uniq_col_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{col_name}{table_name}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">table_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">])</span>
    <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;obs_id&#39;</span><span class="p">])</span>

    <span class="n">masked_result</span> <span class="o">=</span> <span class="n">_filter_products</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="n">campaign</span><span class="p">,</span>
                                     <span class="n">quarter</span><span class="o">=</span><span class="n">quarter</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="n">cadence</span><span class="p">,</span>
                                     <span class="n">project</span><span class="o">=</span><span class="n">mission</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="n">sector</span><span class="p">,</span>
                                     <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SearchResult</span><span class="p">(</span><span class="n">masked_result</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_query_mast</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Kepler&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;TESS&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Helper function which wraps `astroquery.mast.Observations.query_criteria()`</span>
<span class="sd">    to returns a table of all Kepler or K2 observations of a given target.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : str, int, or `astropy.coordinates.SkyCoord` object</span>
<span class="sd">        See docstrings above.</span>
<span class="sd">    radius : float or `astropy.units.Quantity` object</span>
<span class="sd">        Conesearch radius.  If a float is given it will be assumed to be in</span>
<span class="sd">        units of arcseconds.  If `None` then we default to 0.0001 arcsec.</span>
<span class="sd">    project : str, list of str</span>
<span class="sd">        &#39;Kepler&#39;, &#39;K2&#39;, and/or &#39;TESS&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    obs : astropy.Table</span>
<span class="sd">        Table detailing the available observations on MAST.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If passed a SkyCoord, convert it to an RA and Dec</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
        <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

    <span class="n">project</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="o">.</span><span class="mi">0001</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># If `target` looks like a KIC or EPIC ID, we will pass the exact</span>
        <span class="c1"># `target_name` under which MAST will know the object to prevent</span>
        <span class="c1"># source confusion (see GitHub issue #148).</span>
        <span class="n">target</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">target</span> <span class="o">&lt;</span> <span class="mi">200000000</span><span class="p">):</span>
            <span class="n">target_name</span> <span class="o">=</span> <span class="s1">&#39;kplr</span><span class="si">{:09d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="mi">200000000</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">target</span> <span class="o">&lt;</span> <span class="mi">300000000</span><span class="p">):</span>
            <span class="n">target_name</span> <span class="o">=</span> <span class="s1">&#39;ktwo</span><span class="si">{:09d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:09d}</span><span class="s2">: not in the KIC or EPIC ID range&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

        <span class="c1"># query_criteria does not allow a cone search when target_name is passed in</span>
        <span class="c1"># so first grab desired target with ~0 arcsecond radius</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="c1"># suppress misleading AstropyWarning</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">AstropyWarning</span><span class="p">)</span>
            <span class="n">target_obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
                                                     <span class="n">radius</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)),</span>
                                                     <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
                                                     <span class="n">obs_collection</span><span class="o">=</span><span class="n">project</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_obs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No observations found for </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_name</span><span class="p">))</span>

        <span class="c1"># check if a cone search is being performed</span>
        <span class="c1"># if yes, perform a cone search around coordinates of desired target</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">):</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">target_obs</span>
            <span class="c1"># astroquery does not return distance if target_name is given;</span>
            <span class="c1"># we add it here so that the table returned always has this column.</span>
            <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ra</span> <span class="o">=</span> <span class="n">target_obs</span><span class="p">[</span><span class="s1">&#39;s_ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">target_obs</span><span class="p">[</span><span class="s1">&#39;s_dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="c1"># suppress misleading AstropyWarning</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">AstropyWarning</span><span class="p">)</span>
                <span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">),</span>
                                                  <span class="n">radius</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)),</span>
                                                  <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
                                                  <span class="n">obs_collection</span><span class="o">=</span><span class="n">project</span><span class="p">)</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obs</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># If `target` did not look like a KIC or EPIC ID, then we let MAST</span>
    <span class="c1"># resolve the target name to a sky position. Convert radius from arcsec</span>
    <span class="c1"># to degrees for query_criteria().</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="c1"># suppress misleading AstropyWarning</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">AstropyWarning</span><span class="p">)</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">objectname</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                                              <span class="n">radius</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)),</span>
                                              <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
                                              <span class="n">obs_collection</span><span class="o">=</span><span class="n">project</span><span class="p">)</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obs</span>
    <span class="k">except</span> <span class="n">ResolverError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SearchError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_filter_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Kepler&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;TESS&#39;</span><span class="p">],</span>
                     <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;Target Pixel&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function which filters a SearchResult&#39;s products table by one or</span>
<span class="sd">    more criteria.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    products : `astropy.table.Table` object</span>
<span class="sd">        Astropy table containing data products returned by MAST</span>
<span class="sd">    campaign : int or list</span>
<span class="sd">        Desired campaign of observation for data products</span>
<span class="sd">    quarter : int or list</span>
<span class="sd">        Desired quarter of observation for data products</span>
<span class="sd">    month : int or list</span>
<span class="sd">        Desired month of observation for data products</span>
<span class="sd">    cadence : str</span>
<span class="sd">        Desired cadence (`long`, `short`, `any`)</span>
<span class="sd">    filetype : str</span>
<span class="sd">        Type of files queried at MAST (`Target Pixel` or `Lightcurve`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    products : `astropy.table.Table` object</span>
<span class="sd">        Masked astropy table containing desired data products</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
    <span class="n">project_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project</span><span class="p">]</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;kepler&#39;</span> <span class="ow">in</span> <span class="n">project_lower</span> <span class="ow">and</span> <span class="n">campaign</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="n">_mask_kepler_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="n">quarter</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span>
                                      <span class="n">cadence</span><span class="o">=</span><span class="n">cadence</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;k2&#39;</span> <span class="ow">in</span> <span class="n">project_lower</span> <span class="ow">and</span> <span class="n">quarter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="n">_mask_k2_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="n">campaign</span><span class="p">,</span>
                                  <span class="n">cadence</span><span class="o">=</span><span class="n">cadence</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;tess&#39;</span> <span class="ow">in</span> <span class="n">project_lower</span> <span class="ow">and</span> <span class="n">quarter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">campaign</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="n">_mask_tess_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="n">sector</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">)</span>

    <span class="n">products</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">products</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;productFilename&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">limit</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">products</span>


<span class="k">def</span> <span class="nf">_mask_kepler_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span>
                          <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;Target Pixel&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask flagging the Kepler products that match the criteria.&quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">proj</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;kepler&#39;</span> <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mask</span>

    <span class="c1"># Allow only fits files</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span> <span class="ow">or</span>
                      <span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits.gz&#39;</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">]])</span>

    <span class="c1"># Filters on cadence and product type</span>
    <span class="k">if</span> <span class="n">cadence</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;short&#39;</span><span class="p">,</span> <span class="s1">&#39;sc&#39;</span><span class="p">]:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Short&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cadence</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Long&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">description_string</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>

    <span class="c1"># Identify quarter by the description.</span>
    <span class="k">if</span> <span class="n">quarter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quarter_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">quarter</span><span class="p">):</span>
            <span class="n">quarter_mask</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">desc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;q</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
                                      <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>
        <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">quarter_mask</span>

    <span class="c1"># For Kepler short cadence data the month can be specified</span>
    <span class="k">if</span> <span class="n">month</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
        <span class="c1"># Get the short cadence date lookup table.</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PACKAGEDIR</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;short_cadence_month_lookup.csv&#39;</span><span class="p">))</span>
        <span class="c1"># The following line is needed for systems where the default integer type</span>
        <span class="c1"># is int32 (e.g. Windows/Appveyor), the column will then be interpreted</span>
        <span class="c1"># as string which makes the test fail.</span>
        <span class="n">table</span><span class="p">[</span><span class="s1">&#39;StartTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;StartTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="c1"># Grab the dates of each of the short cadence files.</span>
        <span class="c1"># Make sure every entry has the correct month</span>
        <span class="n">is_shortcadence</span> <span class="o">=</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="s1">&#39;Short&#39;</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_shortcadence</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">quarter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;dataURI&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">permitted_dates</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">month</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">permitted_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;StartTime&#39;</span><span class="p">][</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">quarter</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                    <span class="p">])</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">date</span> <span class="ow">in</span> <span class="n">permitted_dates</span><span class="p">):</span>
                <span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">mask</span>


<span class="k">def</span> <span class="nf">_mask_k2_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">campaign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cadence</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;Target Pixel&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask flagging the K2 products that match the criteria.&quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">proj</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;k2&#39;</span> <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mask</span>

    <span class="c1"># Allow only fits files</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span> <span class="ow">or</span>
                      <span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits.gz&#39;</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">]])</span>

    <span class="c1"># Filters on cadence and product type</span>
    <span class="k">if</span> <span class="n">cadence</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;short&#39;</span><span class="p">,</span> <span class="s1">&#39;sc&#39;</span><span class="p">]:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Short&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cadence</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">description_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Long&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">description_string</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>

    <span class="c1"># Identify campaign by the description.</span>
    <span class="k">if</span> <span class="n">campaign</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">campaign_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">campaign</span><span class="p">):</span>
            <span class="n">campaign_mask</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;c</span><span class="si">{:02d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">desc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">or</span>
                                       <span class="s1">&#39;c</span><span class="si">{:03d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">desc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                       <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>
        <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">campaign_mask</span>

    <span class="k">return</span> <span class="n">mask</span>


<span class="k">def</span> <span class="nf">_mask_tess_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;Target Pixel&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask flagging the TESS products that match the criteria.&quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;spoc&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mask</span>

    <span class="c1"># Allow only fits files</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span> <span class="ow">or</span>
                      <span class="n">uri</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;fits.gz&#39;</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">]])</span>

    <span class="c1"># Filter on product type</span>
    <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;Lightcurve&#39;</span><span class="p">:</span>
            <span class="n">description_string</span> <span class="o">=</span> <span class="s1">&#39;Light curves&#39;</span>
    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;Target Pixel&#39;</span><span class="p">:</span>
            <span class="n">description_string</span> <span class="o">=</span> <span class="s1">&#39;Target pixel files&#39;</span>
    <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">description_string</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]])</span>

    <span class="c1"># Identify sector by the description.</span>
    <span class="k">if</span> <span class="n">sector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sector_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">sector</span><span class="p">):</span>
            <span class="n">sector_mask</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;s</span><span class="si">{:04d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                                     <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">products</span><span class="p">[</span><span class="s1">&#39;productFilename&#39;</span><span class="p">]])</span>
        <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">sector_mask</span>

    <span class="k">return</span> <span class="n">mask</span>


<div class="viewcode-block" id="open"><a class="viewcode-back" href="../../api/lightkurve.search.open.html#lightkurve.search.open">[docs]</a><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">path_or_url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Opens a Kepler or TESS data product.</span>

<span class="sd">    This function will use the `detect_filetype()` function to</span>
<span class="sd">    automatically detect the type of the data product, and return the</span>
<span class="sd">    appropriate object. File types currently supported are::</span>

<span class="sd">        * `KeplerTargetPixelFile` (typical suffix &quot;-targ.fits.gz&quot;);</span>
<span class="sd">        * `KeplerLightCurveFile` (typical suffix &quot;llc.fits&quot;);</span>
<span class="sd">        * `TessTargetPixelFile` (typical suffix &quot;_tp.fits&quot;);</span>
<span class="sd">        * `TessLightCurveFile` (typical suffix &quot;_lc.fits&quot;).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path_or_url : str</span>
<span class="sd">        Path or URL of a FITS file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : a subclass of :class:`TargetPixelFile` or :class:`LightCurveFile`,</span>
<span class="sd">        depending on the detected file type.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError : raised if the data product is not recognized as a Kepler or</span>
<span class="sd">        TESS product.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    To open a target pixel file using its path or URL, simply use:</span>

<span class="sd">        &gt;&gt;&gt; tpf = open(&quot;mytpf.fits&quot;)  # doctest: +SKIP</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pass header into `detect_filetype()`</span>
    <span class="n">filetype</span> <span class="o">=</span> <span class="n">detect_filetype</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path_or_url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

    <span class="c1"># if the filetype is recognized, instantiate a class of that name</span>
    <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="s1">&#39;lightkurve&#39;</span><span class="p">),</span> <span class="n">filetype</span><span class="p">)(</span><span class="n">path_or_url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if these keywords don&#39;t exist, raise `ValueError`</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not recognized as a Kepler or TESS data product: &quot;</span>
                         <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_or_url</span><span class="p">))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright lightkurve developers and contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>